<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Synthetic Liquidity Ledger</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- =================== SIDEBAR =================== -->
  <aside id="sidebar" class="sidebar">
    <div class="sidebar-brand">
      <div class="brand-icon">‚ö°</div>
      <div>
        <h1 class="brand-title">Ledger</h1>
        <p class="brand-sub">Synthetic Liquidity</p>
      </div>
    </div>

    <nav class="sidebar-nav">
      <button class="nav-btn active" data-page="dashboard">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="3" height="7" rx="1"/><rect x="14" y="14" width="3" height="3" rx="1"/><rect x="3" y="14" width="7" height="3" rx="1"/></svg>
        Dashboard
      </button>
      <button class="nav-btn" data-page="workers">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
        Workers
      </button>
      <button class="nav-btn" data-page="obligations">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
        Obligations
      </button>
      <button class="nav-btn" data-page="settlement">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
        Settlement
      </button>
      <button class="nav-btn" data-page="ingestion">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
        Income Data
      </button>
    </nav>

    <div class="sidebar-footer">
      <button class="nav-btn nav-btn-danger" id="btnSignOut">
        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
        Sign Out
      </button>
    </div>
  </aside>

  <!-- =================== MAIN =================== -->
  <div class="main-wrapper">

    <!-- NAVBAR -->
    <nav class="navbar">
      <div class="navbar-left">
        <button id="menuToggle" class="menu-toggle">‚ò∞</button>
        <div>
          <h2 class="navbar-title">Admin Dashboard</h2>
          <p class="navbar-sub">Synthetic Liquidity Settlement</p>
        </div>
      </div>
      <div class="navbar-right">
        <div class="status-pill"><span class="pulse"></span> DEV</div>
        <div class="avatar-block">
          <div class="avatar"></div>
          <div class="avatar-info">
            <span class="avatar-name">Admin</span>
            <span class="avatar-role">System</span>
          </div>
        </div>
      </div>
    </nav>

    <!-- ==================== PAGES ==================== -->

    <!-- DASHBOARD PAGE -->
    <main id="page-dashboard" class="page active">
      <div class="page-inner">
        <div class="page-header">
          <h1>Ledger Dashboard</h1>
          <p>Real-time view of synthetic liquidity settlement across all pools</p>
        </div>

        <!-- Balance Cards -->
        <div id="balanceGrid" class="balance-grid">
          <!-- JS populates -->
        </div>

        <!-- Two-column layout -->
        <div class="grid-2-1">
          <!-- Left -->
          <div class="stack">
            <!-- Obligations summary -->
            <div class="card" id="obligationsCard">
              <div class="card-header">
                <div>
                  <h3>Open Obligations</h3>
                  <p class="card-sub">Settlement exposure across pools</p>
                </div>
                <span class="icon-warning">‚ö†Ô∏è</span>
              </div>
              <div class="metric-row" id="obligationMetrics">
                <div class="metric">
                  <span class="metric-label">Gross Exposure</span>
                  <span class="metric-value" id="metricGross">$0.00</span>
                </div>
                <div class="metric">
                  <span class="metric-label">Net Exposure</span>
                  <span class="metric-value" id="metricNet">$0.00</span>
                </div>
                <div class="metric">
                  <span class="metric-label">Compression</span>
                  <span class="metric-value accent" id="metricCompression">0%</span>
                </div>
              </div>
              <h4 class="sub-heading">Top Pool Pairs</h4>
              <table class="data-table">
                <thead><tr><th>From</th><th>To</th><th>Amount (USD)</th><th>Status</th></tr></thead>
                <tbody id="obligationsBody"></tbody>
              </table>
            </div>

            <!-- Liquidity Health -->
            <div class="card" id="liquidityCard">
              <div class="card-header">
                <h3>Liquidity Health</h3>
              </div>
              <div id="liquidityBars"></div>
            </div>
          </div>

          <!-- Right -->
          <div class="stack">
            <!-- Key Metrics -->
            <div class="card">
              <div class="card-header"><h3>Key Metrics</h3></div>
              <div class="kpi-stack">
                <div class="kpi">
                  <span class="kpi-icon">üìä</span>
                  <span class="kpi-label">Gross Exposure</span>
                  <span class="kpi-value" id="kpiGross">$0.00</span>
                </div>
                <div class="kpi">
                  <span class="kpi-icon">üìà</span>
                  <span class="kpi-label">Net Exposure</span>
                  <span class="kpi-value" id="kpiNet">$0.00</span>
                </div>
                <div class="kpi">
                  <span class="kpi-icon">üìã</span>
                  <span class="kpi-label">Queued Payouts</span>
                  <span class="kpi-value" id="kpiQueued">0</span>
                </div>
                <div class="kpi">
                  <span class="kpi-icon">üè¶</span>
                  <span class="kpi-label">Total Accounts</span>
                  <span class="kpi-value" id="kpiAccounts">0</span>
                </div>
              </div>
            </div>

            <!-- Activity Feed -->
            <div class="card">
              <div class="card-header"><h3>Recent Activity</h3></div>
              <div id="activityFeed" class="activity-feed">
                <p class="text-muted">Loading‚Ä¶</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- WORKERS PAGE -->
    <main id="page-workers" class="page">
      <div class="page-inner">
        <div class="page-header">
          <h1>Worker Portal</h1>
          <p>View balances and transaction history for gig workers</p>
        </div>
        <div class="card">
          <div class="card-header"><h3>Select Worker</h3></div>
          <div class="form-row">
            <select id="workerSelect" class="input"><option value="">Loading‚Ä¶</option></select>
            <button id="btnLoadWorker" class="btn btn-primary">Load</button>
          </div>
        </div>
        <div id="workerDetail" class="stack" style="display:none">
          <div class="balance-grid" id="workerBalanceGrid"></div>
          <div class="card">
            <div class="card-header"><h3>Transaction History</h3></div>
            <table class="data-table">
              <thead><tr><th>#</th><th>Type</th><th>Amount</th><th>Direction</th><th>Date</th></tr></thead>
              <tbody id="workerTxBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </main>

    <!-- OBLIGATIONS PAGE -->
    <main id="page-obligations" class="page">
      <div class="page-inner">
        <div class="page-header">
          <h1>Open Obligations</h1>
          <p>All outstanding cross-pool obligations</p>
        </div>
        <div class="card">
          <table class="data-table">
            <thead><tr><th>ID</th><th>From Pool</th><th>To Pool</th><th>Amount (USD)</th><th>Status</th></tr></thead>
            <tbody id="fullObligationsBody"></tbody>
          </table>
          <p id="noObligations" class="text-muted" style="display:none">No open obligations.</p>
        </div>
      </div>
    </main>

    <!-- SETTLEMENT PAGE -->
    <main id="page-settlement" class="page">
      <div class="page-inner">
        <div class="page-header">
          <h1>Settlement</h1>
          <p>Run netting settlement across pools</p>
        </div>
        <div class="card">
          <div class="card-header">
            <h3>Run Settlement</h3>
          </div>
          <div class="form-row">
            <label class="input-label">
              Threshold (USD cents)
              <input id="settleThreshold" type="number" class="input" value="0" min="0" />
            </label>
            <button id="btnSettle" class="btn btn-primary">‚ö° Execute Settlement</button>
          </div>
          <div id="settleResult" class="result-box" style="display:none"></div>
        </div>
        <div class="card">
          <div class="card-header"><h3>Net Positions</h3></div>
          <table class="data-table">
            <thead><tr><th>Pool A</th><th>Pool B</th><th>Net (USD)</th><th>Abs (USD)</th></tr></thead>
            <tbody id="netPositionsBody"></tbody>
          </table>
        </div>
      </div>
    </main>

    <!-- INGESTION PAGE -->
    <main id="page-ingestion" class="page">
      <div class="page-inner">
        <div class="page-header">
          <h1>Income Data Pipeline</h1>
          <p>Ingest worker earnings &amp; compute income smoothing</p>
        </div>
        <div class="card">
          <div class="card-header"><h3>Pipeline Health</h3></div>
          <div id="ingestionHealth" class="kpi-stack"></div>
        </div>
        <div class="card">
          <div class="card-header"><h3>Ingest Worker</h3></div>
          <div class="form-row">
            <label class="input-label">
              Worker ID
              <input id="ingestWorkerId" class="input" value="worker-1" />
            </label>
            <label class="input-label">
              Delta (minor)
              <input id="ingestDelta" type="number" class="input" value="500" />
            </label>
            <button id="btnIngest" class="btn btn-primary">Run Ingestion</button>
          </div>
          <div id="ingestResult" class="result-box" style="display:none"></div>
        </div>
      </div>
    </main>

  </div><!-- /main-wrapper -->

  <!-- Toast container -->
  <div id="toastContainer" class="toast-container"></div>

  <script src="app.js"></script>
</body>
</html>
